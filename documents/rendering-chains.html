<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width">
<title>Customized rendering chains -- fileName.html.xyz.abc.ksk</title>
<meta name="pagename" content="Customized rendering chains -- fileName.html.xyz.abc.ksk">
<meta name="date" content="Wed May 11 2016 23:12:46 GMT-0700 (PDT)">
<meta name="DC.title" content="Customized rendering chains -- fileName.html.xyz.abc.ksk">
<meta name="og:title" content="Customized rendering chains -- fileName.html.xyz.abc.ksk">
<meta name="og:url" content="https://akashacms.com/documents/rendering-chains.html">
<link rel="canonical" href="https://akashacms.com/documents/rendering-chains.html">
<link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">
<link rel="stylesheet" type="text/css" href="/akasha/epub-website/style.css"><link rel="stylesheet" type="text/css" href="/vendor/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="/vendor/bootstrap/css/bootstrap-theme.min.css"><link rel="stylesheet" type="text/css" href="/readable.min.css"><link rel="stylesheet" type="text/css" href="/style.css">
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=234745903279111";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@akashacms">
<meta name="twitter:creator" content="@7genblogger">
<meta name="twitter:url" content="https://akashacms.com/documents/rendering-chains.html">
<meta name="twitter:title" content="Customized rendering chains -- fileName.html.xyz.abc.ksk">
<meta name="twitter:image" content="http://akashacms.com/logo.gif">
</head>
<body>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
<button class="navbar-toggle" data-toggle="collapse" data-target=".navHeaderCollapse">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<div class="navbar-collapse collapse navHeaderCollapse">
<ul class="nav navbar-nav navbar-rights">
<li><a href="/index.html">Home</a></li>
<li><a href="/install.html">Installation</a></li>
<li><a href="/configuration/index.html">Configuration</a></li>
<li><a href="/documents/index.html">Documents</a></li>
<li><a href="/plugins/index.html">Plugins</a></li>
<li><a href="/plugins/epub.html">AkashaEPUB</a></li>
<li><a href="/layout/index.html">Layouts</a></li>
<li><a href="/theming/index.html">Theming</a></li>
<li><a href="/deployment/index.html">Deployment</a></li>
<li><a href="/command-line/index.html">Command Line</a></li>
<li><a href="/howto/index.html">Tutorials</a></li>
<li><a href="/news/index.html">Blog</a></li>
<li><a href="/about.html">About</a></li>
</ul>
</div>
</div>
<div class="container" role="main">
<div class="row">
<header class="col-md-12">
<div class="row">
<span class="col-md-8" style="text-align: center">
<a href="/index.html"><img src="/logo.gif" align="left"></a>
<h1 align="center">Customized rendering chains -- fileName.html.xyz.abc.ksk</h1>
</span>
<span class="col-md-4">
<form action="//www.google.com" id="cse-search-box">
<div>
<input type="hidden" name="cx" value="partner-pub-2401070691062219:4564101022">
<input type="hidden" name="ie" value="UTF-8">
<input type="text" name="q" size="30">
<input type="submit" name="sa" value="Search">
</div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en">
// Not empty
</script>
<br>
</span>
</div>
</header>
</div>
<div class="row">
<div class="col-md-10">
<div class="row">
<section id="breadcrumb" class="col-sm-12">
<div id="breadcrumbTrail">
<ol class="breadcrumb">
<li> <a href="/index.html">AkashaCMS - the powerful static file CMS to build your dream website</a> </li> <li> <a href="/documents/index.html">AkashaCMS documents</a> </li> <li> <a href="/documents/rendering-chains.html">Customized rendering chains -- fileName.html.xyz.abc.ksk</a> </li>
</ol>
</div>
</section>
<section id="category-tags" class="col-sm-12">
By: <author-link></author-link> Date: May 4, 2015
</section>
</div>
<div class="row">
<article class="col-sm-10">
<p>In <a href="extensions.html" title="File names and extensions in AkashaCMS">File names and extensions in AkashaCMS</a> we discussed the file name format and rendering chains supported by default. That is a file named <code>foo.html.md</code> is processed by Markdown, and then written to <code>root_out</code> as <code>foo.html</code>. This is very straightforward, but sometimes we want more flexibility to support any kind of rendering algorithm.</p>
<p>AkashaCMS supports what we&apos;re calling a pluggable rendering chain with with a simple JavaScript object with functions implementing a given rendering algorithm. The same object is used for the built-in rendering chains.</p>
<ul>
<li><a href="https://github.com/akashacms/akashacms/blob/master/lib/md.js">lib/md.js</a> -- Implements <code>foo.html.md</code></li>
<li><a href="https://github.com/akashacms/akashacms/blob/master/lib/renderer-cssless.js">lib/renderer-cssless.js</a> -- Implements <code>foo.css.less</code></li>
<li><a href="https://github.com/akashacms/akashacms/blob/master/lib/renderer-ejs.js">lib/renderer-ejs.js</a> -- Implements <code>foo.html.ejs</code> and <code>foo.html.ejs.md</code></li>
</ul>
<h2>Implementation</h2>
<p>The rendering chain object is as so:</p>
<pre><code>var renderingChain = {
  match: function(fname) {
	var matches;
	if ((matches = fname.match(/^(.*\.ext1)(\.ext2)$/)) !== null) {
	  return {
		path: matches[0],
		renderedFileName: matches[1],
		extension: matches[2]
	  };
	} else {
	  return null;
	}
  },
  renderSync: function(text, metadata) {
    return render_the_text_synchronously(text, metadata);
  },
  render: function(txt, metadata, done) {
    render_the_text_asynchronously(txt, function (err, rendered) {
        if (err) done(err);
        else     done(null, rendered);
    });
  }
};
</code></pre>
<p>The renderChain object has three functions,</p>
<ul>
<li><code>match</code> to indicate whether this renderChain handles a given file name</li>
<li><code>renderSync</code> to render text in a synchronous fashion</li>
<li><code>render</code> to render text in asynchronous fashion</li>
</ul>
<p>The rendering chain implementation needs to take the input text all the way to its final rendering. For example, the implementation of the <code>foo.html.ejs.md</code> rendering chain includes this function:</p>
<pre><code>renderSync: function(text, metadata) {
    return ejs.render(md.renderSync(text), metadata);
},
</code></pre>
<p>The <code>match</code> function serves two functions:</p>
<ul>
<li>Telling the Renderer that this rendering chain matches the file that&apos;s being rendered</li>
<li>What file name into which to write the final rendering</li>
</ul>
<p>The latter is done through the magic of regular expressions. Your regex has to match the final file name, and provide the file extension beyond the final file name, as shown here.</p>
<p>The <code>match</code> function returns an object, as shown above, documenting the full path name, what it needs to render as, and the matching extension. This is needed by other pieces of AkashaCMS to determine what file name to create after processing the file.</p>
<p>The <code>render</code> and <code>renderSync</code> methods handle content rendering in cases constrained by synchronous code execution, or in cases allowing asynchronous code execution. If the given rendering algorithm doesn&apos;t support one or the other, simply make the appropriate function null.</p>
<p>It&apos;s sometimes useful to make each rendering chain a standalone module:</p>
<pre><code>module.exports = {
  match: ...,
  renderSync: ...,
  render: ...
};
</code></pre>
<h2>Registering a Rendering chain</h2>
<p>One informs AkashaCMS of a rendering chain with the <code>registerRenderChain</code> method:</p>
<p>An example is:</p>
<pre><code>var renderingChain1 = require(&apos;./lib/renderingChain1&apos;);
var renderingChain2 = require(&apos;./lib/renderingChain2&apos;);
var renderingChain3 = require(&apos;./lib/renderingChain3&apos;);
var renderingChain4 = require(&apos;./lib/renderingChain4&apos;);

    ...
    [ renderingChain1, renderingChain2, renderingChain3, renderingChain4 ].forEach(function(renderer) {
		akashacms.registerRenderChain(renderer);
	});
	...
</code></pre>
<p>Or</p>
<pre><code>akashacms.registerRenderChain({
    match: ...,
    renderSync: ...,
    render: ...
});
</code></pre>
<div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'akashacms'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>
<section id="right" class="col-sm-2">
</section>
</div>
</div>
<div class="col-md-2">
<p>AkashaCMS developed by the author of <a rel="nofollow noskim" href="https://www.amazon.com/gp/product/1785881507/ref=as_li_ss_il?ie=UTF8&amp;fpl=fresh&amp;pf_rd_m=ATVPDKIKX0DER&amp;pf_rd_s=&amp;pf_rd_r=6C1SVA4RRTWPTY7VN1Z2&amp;pf_rd_t=36701&amp;pf_rd_p=14bf09e4-93c8-43ff-8639-e7979e7d1787&amp;pf_rd_i=desktop&amp;linkCode=li2&amp;tag=davidherron-20&amp;linkId=1a83c9a47355206fbe8622bf9e90b086">Node Web Development</a>
</p>
<a rel="nofollow noskim" href="https://www.amazon.com/gp/product/1785881507/ref=as_li_ss_il?ie=UTF8&amp;fpl=fresh&amp;pf_rd_m=ATVPDKIKX0DER&amp;pf_rd_s=&amp;pf_rd_r=6C1SVA4RRTWPTY7VN1Z2&amp;pf_rd_t=36701&amp;pf_rd_p=14bf09e4-93c8-43ff-8639-e7979e7d1787&amp;pf_rd_i=desktop&amp;linkCode=li2&amp;tag=davidherron-20&amp;linkId=1a83c9a47355206fbe8622bf9e90b086" target="_blank"><img border="0" src="//ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1785881507&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=davidherron-20"></a>
<span class="st_sharethis" st_title="Customized rendering chains -- fileName.html.xyz.abc.ksk">
<span class="st_tumblr_large"></span><span class="st_stumbleupon_large"></span><span class="st_care2_large"></span><span class="st_twitter_large"></span><span class="st_facebook_large"></span><span class="st_yahoo_large"></span><span class="st_blogger_large"></span><span class="st_sharethis_large"></span>
</span>
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript">
stLight.options({
    
    
    
    
    
    
    
    publisher:'c828d855-27af-4910-b7a5-2b9b14030895'
});
</script>
<a href="http://www.reddit.com/submit" onclick="window.location = &apos;http://www.reddit.com/submit?url=&apos; + encodeURIComponent(window.location); return false"> <img src="http://www.reddit.com/static/spreddit7.gif" alt="submit to reddit" border="0"> </a>
<script type="text/javascript">
(function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js?onload=onLoadCallback';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<g:plusone></g:plusone>
<a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
<a href="https://twitter.com/AkashaCMS" rel="me nofollow" class="twitter-follow-button" data-show-count="false">Follow<br>@AkashaCMS</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</div>
</div>
<footer class="row" style="text-align: center; height: 100px">
<div class="fb-like-box" data-href="http://www.facebook.com/Akashacms" data-width="125" data-height="250" data-show-faces="false" data-stream="false" data-header="true"></div>
</footer>
</div>
<script src="/vendor/jquery/jquery.min.js"></script><script src="/vendor/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript">
var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37003917-1']);
  _gaq.push(['_setDomainName', 'akashacms.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>
