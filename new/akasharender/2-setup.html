<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width">
<title>Project Setup</title>
<meta name="pagename" content="Project Setup">
<meta name="date" content="Mon May 15 2017 12:42:43 GMT-0700 (PDT)">
<meta name="DC.title" content="Project Setup">
<meta name="og:title" content="Project Setup">
<meta name="og:url" content="https://akashacms.com/new/akasharender/2-setup.html">
<link rel="canonical" href="https://akashacms.com/new/akasharender/2-setup.html">
<link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">
<link rel="stylesheet" type="text/css" href="/akasha/epub-website/style.css"><link rel="stylesheet" type="text/css" href="/vendor/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="/vendor/bootstrap/css/bootstrap-theme.min.css"><link rel="stylesheet" type="text/css" href="/readable.min.css"><link rel="stylesheet" type="text/css" href="/style.css">
<style>
html, body {
    height:100%;
    max-height:100%;
    margin:0;
}

#page-container {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    flex-wrap: nowrap;
}

#site-navbar {
    display: none;
    flex-shrink: 0;
    height: 30px;
}

#ebook-masthead {
    flex-shrink: 0;
    height: 60px;
}

#ebook-masthead h2 {
    font-size: 22px;
    margin-top: 0px;
}

#ebook-navigation {
    flex-shrink: 0;
    height: 60px;
}

#book-page-content {
    flex-grow: 1;
    overflow: auto;
    min-height: 2em;
}

#footer-row {
    display: none;
    flex-shrink: 0;
    height: 50px;
    background-color: grey;
}
</style>
</head>
<body class="ebook-page">
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
<button class="navbar-toggle" data-toggle="collapse" data-target=".navHeaderCollapse">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<div class="navbar-collapse collapse navHeaderCollapse">
<ul class="nav navbar-nav navbar-rights">
<li><a href="/new/index.html">Home</a></li>
<li><a href="/new/akasharender/toc.html">AkashaRender</a></li>
<li><a href="/new/plugins/index.html">Plugins</a></li>
<li><a href="/new/mahabhuta/toc.html">Mahabhuta</a></li>
<li><a href="/new/epubtools/toc.html">EPUB Tools</a></li>
</ul>
</div>
</div>
<div id="page-container">
<header class="epub-website-ebook-masthead" id="ebook-masthead">
<table border="0"><tr>
<td class="epub-website-ebook-masthead-title">
<a href="/new/akasharender/toc.html"><h2 align="center">AkashaRender User Guide</h2></a><em>By David Herron</em>
</td>
</tr></table>
</header>
<div class="panel panel-default">
<div class="panel-heading epub-website-ebook-navigation-header" id="ebook-navigation">
<div class="epub-website-ebook-logo-area">
<div class="btn-group">
<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
Table of Contents
<span class="caret"></span>
</button>
<ol type="1" start="1" class="dropdown-menu">
<li><a href="index.html" id="index" title="AkashaRender">AkashaRender</a></li>
<li><a href="2-setup.html" id="setup" title="Project Setup">Project Setup</a></li>
<li><a href="3-create-content.html" id="create-content" title="Creating content with AkashaRender">Creating content with AkashaRender</a></li>
<li><a href="configuration.html" id="configuration" title="Configuring an AkashaCMS/AkashaRender project">Configuring an AkashaCMS/AkashaRender project</a></li>
</ol>
</div>
</div>
<div class="epub-website-ebook-chapter-area">
<a href="index.html">
<span class="epub-website-ebook-chevron-left glyphicon glyphicon-chevron-left" aria-hidden="true" style=""></span>
</a>
<h1 class="panel-title" align="center" style="">Project Setup</h1>
<a href="3-create-content.html">
<span class="glyphicon glyphicon-chevron-right" aria-hidden="true" style="display: inline"></span>
</a>
</div>
</div>
<div id="book-page-content" class="panel-body">
<div id="book-page-content" class="panel-body"><p>An AkashaRender project directory has these attributes:</p>
<ul>
<li><code>package.json</code> This file lists dependencies on Node.js packages used to build the project, and a <em>scripts</em> section containing commands to drive the rendering and deployment process.</li>
<li>Several input directories to hold project assets, content files, layout templates, and partials (smaller templates).</li>
<li>One or more AkashaRender configuration files, <em>e.g.</em> <code>config.js</code>, describing the rendering process. Typically there will be one configuration file, but sometimes you&apos;ll need more than one to reuse the same content for multiple destinations.</li>
<li>(Optionally) Another Node.js script containing DOM processing functions for use with the Mahabhuta engine.</li>
</ul>
<h2>Simple project initialization</h2>
<p>Start by making a project directory:</p>
<pre><code>$ mkdir myproject
$ cd myproject
$ npm init
... answer all the questions asked by npm init

Is this ok? (yes) yes
</code></pre>
<p>Then install AkashaRender and globfs.</p>
<pre><code>$ npm install globfs akasharender --save
</code></pre>
<p>If this project is to generate an EPUB3, then you must also install epubtools:</p>
<pre><code>$ npm install epubtools --save
</code></pre>
<p>Next, make some directories:</p>
<pre><code>$ mkdir assets documents layouts partials
</code></pre>
<p>Make an empty CSS file (or fill it with CSS of your desire)</p>
<pre><code>$ mkdir assets/style
$ touch assets/style/main.css
</code></pre>
<p>It&apos;s also easy to use LESS that is autocompiled to CSS. Do this instead:</p>
<pre><code>$ mkdir documents/style
$ touch documents/style/main.css.less
</code></pre>
<p>We&apos;ll go over this later, but AkashaRender automatically compiles LESS code to CSS when the file is named with this double extension.</p>
<h2>A simple template file</h2>
<p>Create a simple layout template as <code>layouts/page.html.ejs</code> containing</p>
<pre><code>&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot; /&gt;
&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge,chrome=1&quot; /&gt;
&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;/&gt;
&lt;title&gt;&lt;%= title %&gt;&lt;/title&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;/style/main.css&quot;
      type=&quot;text/css&quot; media=&quot;screen&quot;/&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;%- content %&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>The double file extension is a convention in AkashaRender meant to indicate</p>
<ul>
<li><code>filename.css.less</code>: The file is first compiled from LESS, and is output as CSS to: <code>filename.css</code></li>
<li><code>filename.html.ejs</code>: The file is rendered with EJS, and is output as HTML to: <code>filename.html</code></li>
<li><code>filename.html.md</code>: The file is rendered with Markdown, and is output as HTML to: <code>filename.html</code></li>
</ul>
<p>The template file demonstrates two types of content inclusion, using EJS. With <code>&lt;%= title %&gt;</code> we are inserting a metadata value with interpolation such that any HTML tags get encoded. However with <code>&lt;%- content %&gt;</code> the metadata value is not encoded, so that any HTML tags are copied verbatim.</p>
<p>The <code>content</code> variable is special in that it&apos;s the result of the previous rendering. All other values we might include come from the frontmatter.</p>
<h2>A simple content file</h2>
<p>Now let&apos;s create a simple content document, as <code>documents/index.html.md</code>.</p>
<pre><code>---
layout: page.html.ejs
title: Four Score and Seven Years Ago
---

Four score and seven years ago our fathers brought forth on this continent a new nation conceived in liberty and dedicated to the proposition that all men are created equal.
</code></pre>
<p>The frontmatter appears between the --- lines. It is formatted with YAML, a fairly simple markup system to represent data objects as simple text. The best documentation I know of for YAML is on the Wikipedia: <a href="https://en.wikipedia.org/wiki/YAML">https://en.wikipedia.org/wiki/YAML</a></p>
<p>The way to interpret the file name is to think of multiple extensions that describe the conversion process and the final output format. In this case the file is written in Markdown, and produces HTML.</p>
<h2>A simple configuration file</h2>
<p>An AkashaRender configuration file is actually a Node.js script. It contains Configuration commands describing how to render this content for a specific destination.</p>
<p>A typical name for this file is <code>config.js</code>.</p>
<pre><code>&apos;use strict&apos;;

const akasha  = require(&apos;akasharender&apos;);

const config = new akasha.Configuration();

config.rootURL(&quot;http://example.com&quot;);

config
    .addAssetsDir(&apos;assets&apos;)
    .addLayoutsDir(&apos;layouts&apos;)
    .addDocumentsDir(&apos;documents&apos;)
    .addPartialsDir(&apos;partials&apos;);

config.setMahabhutaConfig({
    recognizeSelfClosing: true,
    recognizeCDATA: true
});

config.prepare();

module.exports = config;
</code></pre>
<p>The <code>akasha.Configuration</code> object contains all the data describing the rendering of input files to produce an output - such as an eBook or website.</p>
<p>The first section we show tells AkashaRender the input directories to use, and their purpose. These commands aren&apos;t entirely necessary, because of the baked-in default directory names. But, if you need to change the names you can use these functions.</p>
<p>The <code>.setMahabhutaConfig</code> method is necessary for the Mahabhuta DOM processing engine. Mahabhuta supports a jQuery-like API for processing HTML during the rendering process. Because it uses Cheerio under-the-covers, the values specified in this object actually from the Cheerio project.</p>
<p>The <code>.prepare</code> method adds the baked-in default configuration values so that AkashaRender will be able to function even if you forgot to declare something.</p>
<p>The last line is required for AkashaRender to access the configuration data.</p>
<h2>A build simple process</h2>
<p>The last thing is to set up the scripts section of the <code>package.json</code> with tasks used in building the project:</p>
<pre><code>&quot;scripts&quot;: {
  &quot;clean&quot;: &quot;rm -rf out&quot;,
  &quot;prebuild&quot;: &quot;akasharender copy-assets config.js&quot;,
  &quot;build&quot;: &quot;akasharender render config.js&quot;
},
</code></pre>
<p>This defines two commands, which you can run as so:</p>
<pre><code>$ npm run clean
$ npm run build
</code></pre>
<p>And the project is built for you.</p>
<p>The <code>akasharender</code> command takes several commands, two of which we see here. With <code>copy-assets</code> it copies files from the <em>assets</em> directory to the <em>renderDestination</em> directory. The assets files are ones which AkashaRender does not manipulate, instead they&apos;re copied verbatim. The second command, <code>render</code>, is where AkashaRender does manipulate files. These files are located in the <em>documents</em> directory, and are rendered into the <em>renderDestination</em> directory.</p>
<p>The configuration file is named on the command line so that you can use different configuration files for different purposes. For example it&apos;s possible to take the content of an eBook and render it into an EPUB file or as a website, simply with different configuration files.</p>
</div>
<div class="panel-heading epub-website-ebook-navigation-header" id="ebook-navigation-bottom">
<div class="epub-website-ebook-logo-area">
<div class="btn-group">
<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
Table of Contents
<span class="caret"></span>
</button>
<ol type="1" start="1" class="dropdown-menu">
<li><a href="index.html" id="index" title="AkashaRender">AkashaRender</a></li>
<li><a href="2-setup.html" id="setup" title="Project Setup">Project Setup</a></li>
<li><a href="3-create-content.html" id="create-content" title="Creating content with AkashaRender">Creating content with AkashaRender</a></li>
<li><a href="configuration.html" id="configuration" title="Configuring an AkashaCMS/AkashaRender project">Configuring an AkashaCMS/AkashaRender project</a></li>
</ol>
</div>
</div>
<div class="epub-website-ebook-chapter-area">
<a href="index.html">
<span class="epub-website-ebook-chevron-left glyphicon glyphicon-chevron-left" aria-hidden="true" style=""></span>
</a>
<h1 class="panel-title" align="center" style="">Project Setup</h1>
<a href="3-create-content.html">
<span class="glyphicon glyphicon-chevron-right" aria-hidden="true" style="display: inline"></span>
</a>
</div>
</div>
<div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'akashacms'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
</div>
<footer id="footer-row" class="container">
<div class="fb-like-box" data-href="http://www.facebook.com/Akashacms" data-width="125" data-height="250" data-show-faces="false" data-stream="false" data-header="true"></div>
</footer>
</div>
<script src="/vendor/jquery/jquery.min.js"></script><script src="/vendor/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript">
var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37003917-1']);
  _gaq.push(['_setDomainName', 'akashacms.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>
