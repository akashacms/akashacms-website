<!doctype html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!-- Consider adding a manifest.appcache: h5bp.com/d/Offline -->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width">

<title>Preparing AkashaCMS for 0.3.x, adding plugin support</title>





 
 
 
 













<meta name="pagename" content="Preparing AkashaCMS for 0.3.x, adding plugin support">









<meta name="date" content="Sat Aug 08 2020 22:45:46 GMT-0700 (Pacific Daylight Time)">

<meta name="DC.title" content="Preparing AkashaCMS for 0.3.x, adding plugin support">














<!-- OpenGraph Meta Tags -->

<meta name="og:title" content="Preparing AkashaCMS for 0.3.x, adding plugin support">

<meta name="og:url" content="https://akashacms.com/news/2013/08/plugins-announce.html">


































<link rel="canonical" href="https://akashacms.com/news/2013/08/plugins-announce.html">

<link rel="sitemap" type="application/xml" title="Sitemap" href="../../../sitemap.xml">


<link rel="stylesheet" type="text/css" href="../../../akasha/epub-website/style.css"><link rel="stylesheet" type="text/css" href="../../../vendor/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="../../../pulse.min.css"><link rel="stylesheet" type="text/css" href="../../../style.css"><link rel="stylesheet" type="text/css" href="../../../vendor/fontawesome-free/css/all.min.css"><link rel="stylesheet" type="text/css" href="../../../vendor/highlight.js/styles/tomorrow-night-blue.css">



<!-- Facebook app for AkashaCMS fan page -->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=234745903279111";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



<!-- Twitter summary card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@akashacms">
<meta name="twitter:creator" content="@7genblogger">

<meta name="twitter:url" content="https://akashacms.com/news/2013/08/plugins-announce.html">


<meta name="twitter:title" content="Preparing AkashaCMS for 0.3.x, adding plugin support">


<meta name="twitter:image" content="http://akashacms.com/logo.gif">


</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top" role="navigation">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavDropdown">
    <ul class="navbar-nav navbar-rights">
          <li class="nav-item">
              <a class="nav-link" href="../../../index.html">Home</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="../../../akasharender/toc.html">AkashaRender</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="../../../plugins/index.html">Plugins</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="../../../mahabhuta/toc.html">Mahabhuta</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="../../../epubtools/toc.html">EPUB Tools</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="../../../howto/index.html">How To</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="../../index.html">News</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="../../../about.html">About</a>
          </li>
    </ul>
  </div>
</nav>


<div class="container" role="main">
<div class="row">
<header class="col-md-12">
  <div class="row">
    <span class="col-md-8" style="text-align: center;">
      <a href="../../../index.html"><img src="../../../logo.gif" align="left"></a>
      <h1 align="center">Preparing AkashaCMS for 0.3.x, adding plugin support</h1>
    </span>
    <span class="col-md-4">
      <form action="//www.google.com" id="cse-search-box">
        <div>
          <input type="hidden" name="cx" value="partner-pub-2401070691062219:4564101022">
          <input type="hidden" name="ie" value="UTF-8">
          <input type="text" name="q" size="30">
          <input type="submit" name="sa" value="Search">
        </div>
      </form>
      <script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en">
      // Not empty
      </script>
      <br>

    </span>
  </div>

</header>

</div>

<div class="row">
  <section id="breadcrumb" class="col-sm-12">
    <nav aria-label="breadcrumb" id="breadcrumbTrail">
    <ol class="breadcrumb">
     <li class="breadcrumb-item "> <a href="../../../index.html">AkashaCMS - the powerful static file CMS to build your dream website</a> </li> <li class="breadcrumb-item "> <a href="../../index.html">Announcements and News about AkashaCMS</a> </li> <li class="breadcrumb-item "> <a href="../index.html">AkashaCMS News and Announcements for 2013</a> </li> <li class="breadcrumb-item "> <a href="index.html">AkashaCMS News and Announcements for August 2013</a> </li> <li class="breadcrumb-item "> <a href="plugins-announce.html">Preparing AkashaCMS for 0.3.x, adding plugin support</a> </li>
    </ol>
</nav>

  </section>
  <section id="category-tags" class="col-sm-12">
    
    Date: 2013-08-04 21:08

  </section>
  <section id="author-byline" class="col-sm-12">
    <div class="author-byline" itemprop="author" itemscope itemtype="http://schema.org/Person">
By <span itemprop="name" class="author-name-wrapper"><a href="../../../about.html" rel="author" itemprop="url">David Herron</a></span>
</div>

  </section>
</div>

<div class="row">
  <article class="col-sm-10">
    
    <strong><p><strong><p>I&apos;m going to be declaring AkashaCMS 0.3.x pretty soon, and I have an interesting new feature in the works.&#xA0; The idea is to support multi-way extensibility of the processing of a website via the configuration file.&#xA0; The implementation is a form of &quot;plugin&quot; that allows anybody to write a module that extends the configuration of an AkashaCMS site, add new processing functions, hooks at different steps of the processing, and add directories managed by the plugin containing assets, layouts or partials.</p>

<p>Okay, that was pretty dense so let&apos;s take it one step at a time.</p>
</strong></p>
</strong>
    
    <!-- no hero picture -->

    <p>The first change was to make AkashaCMS configuration files use an array of directory names for - <code>assets</code>, <code>layouts</code> and <code>partials</code>.</p>
<p>When AkashaCMS looks for one of those kinds of files (or for Documents, for that matter) it searches through the array of such directories.&#xA0; This means that in the configuration file you now declare these directories as so:</p>
<pre><code class="hljs"><span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
    root_assets: [ <span class="hljs-string">&apos;boilerplate&apos;</span>, <span class="hljs-string">&apos;assets&apos;</span> ],
    root_layouts: [ <span class="hljs-string">&apos;layouts&apos;</span> ],           <span class="hljs-comment">// Directory for layout files</span>
    root_partials: [ <span class="hljs-string">&apos;partials&apos;</span> ],         <span class="hljs-comment">// Directory for partials</span>
    ...
};
</code></pre>
<p>This by itself was kind of innocuous.&#xA0; But, wait, there&apos;s more.</p>
<p>During initialization, in the <code>akashacms.config</code> function, AkashaCMS calls the <code>config</code> function of each plugin.&#xA0; What&apos;s a plugin?&#xA0; A plugin is an NPM-managed package, which exports a <code>config</code> function.&#xA0; The plugin is given the config file and then can do something like this:</p>
<pre><code class="hljs">config.root_partials.<span class="hljs-keyword">push</span>(path.<span class="hljs-keyword">join</span>(__dirname, <span class="hljs-string">&apos;partials&apos;</span>));
</code></pre>
<p>What this does is add another directory to the <code>root_partials</code> array.&#xA0; The directory in question happens to be inside the package hierarchy of the plugin.&#xA0; That is, Plugins are regular NPM-managed modules, that export a <code>config</code> function where the plugin is going to do things of this sort.</p>
<p>By adding its own directory to the <code>root_partials</code> array, the plugin can back up any functions it adds with support for HTML formatting.</p>
<p>In the common use case, the <code>config</code> function is expected to add some functions that would be available in templates, and for those functions to use partials to render values.</p>
<p>A config function adds template functions this way:</p>
<pre><code class="hljs"><span class="hljs-built_in">config</span>.funcs.siblings = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(arg, callback)</span></span> {
    ..
}
</code></pre>
<p>Remember that any functions in the <code>config.funcs</code> object are available in templates and partials.&#xA0; Such functions are called during processing a template or partial, and they&apos;re expected to gather up or process some data, then render that data through a partial.&#xA0; Therefore, as shown earlier, a plugin can provide its own partial directory to provide its own partials.</p>
<p>AkashaCMS searches the <code>partials</code> and <code>layouts</code> directories in order, declaring success on the first match found.&#xA0; Plugins that add their <code>partials</code> directory using the <code>push</code> function get their directory added at the end of the array.&#xA0; This means a website can override a partial in a plugin, simply by providing a partial with the same name.&#xA0; That&apos;s because the website own <code>partials</code> directory appears earlier in the <code>root_partials</code> array than does the plugin&apos;s <code>partials</code> directory.</p>
<p>What if a plugin wants to provide behavior other than functions evaluated while rendering templates?</p>
<p>AkashaCMS is beginning to emit messages while processing a website.&#xA0; The messages haven&apos;t been thought through completely yet, but the idea is that a plugin will be able to react at different stages of processing a site.</p>
<p>Finally, I haven&apos;t said how plugins are declared.&#xA0; The config file takes an array of plugin names.&#xA0; These plugin names are of the same sort that are used in require statements.&#xA0; In fact, this is how plugins are initialized:</p>
<pre><code class="hljs">// Pull in any plugins to extend AkashaCMS
for (<span class="hljs-name">var</span> i = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; options.plugins.length; i++) {</span>
    require(<span class="hljs-name">options</span>.plugins[i]).config(<span class="hljs-name">module</span>.exports, options)<span class="hljs-comment">;</span>
}
</code></pre>
<p>We step through the <code>plugins</code> array, <code>require</code>&apos;ing each one, and calling its <code>config</code> function, passing in AkashaCMS and the <code>config</code> file.</p>
<p>The next step of AkashaCMS setup allows the <code>config</code> file to contain a <code>config</code> function:</p>
<pre><code class="hljs"><span class="hljs-comment">// Then give the configuration file a shot at extending us</span>
<span class="hljs-keyword">if</span> (options.<span class="hljs-built_in">config</span>) {
    options.<span class="hljs-built_in">config</span>(<span class="hljs-keyword">module</span>.exports);
}
</code></pre>
<p>The way this works is that a configuration file is really a module.&#xA0; As a module, it can require modules, and it can contain code. I haven&apos;t written a plugin yet that uses this facility, but it seems like it&apos;ll be useful sometime.</p>
<p>A few plugins exist right now:</p>
<ul>
<li>`akashacms-booknav`: Provides web page navigational elements similar to the book module in Drupal</li>
<li>`akashacms-breadcrumb`: Generates breadcrumb trails from the heirarchy of pages above this one</li>
<li>`akashacms-tagged-content`: Supports adding tags (taxonomy terms) to pages, and can generate tag clouds or index pages.&#xA0; This plugin isn&apos;t finished yet.</li>
</ul>
<p>I may in the future implement some plugins that are internal to AkashaCMS, because it may be useful to provide some core functionality that is overridable.</p>

    <div class="btn-group blog-prev-next-wrapper" role="group" aria-label="Next/Previous">
    <a class="btn btn-outline-primary blog-prev-link" href="../../2014/04/akashacms-03-announce.html" role="button">
    &#xAB;&#xAB;&#xAB;&#xAB;&#xAB;&#xAB; AkashaCMS v0.3.0 released - major rearchitecting, plugins, improvements, much more planned for v0.4.x</a>
    <a class="btn btn-outline-primary blog-next-link" href="../../2020/08/jamstack-websites.html" role="button">
    <span style="float: right">What is JAMStack and how does it differ from static website generators? &#xBB;&#xBB;&#xBB;&#xBB;&#xBB;&#xBB;</span></a>
</div>
    <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'akashacms'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the 
                    <img class="akashacms-external-links-favicon opengraph-no-promote" src="https://www.google.com/s2/favicons?domain=disqus.com" style="display: inline-block; padding-right: 2px;" alt="(disqus.com)">
                    <a href="https://disqus.com/?ref_noscript" rel="nofollow" target="_blank">comments powered by Disqus.</a></noscript>

                    <img class="akashacms-external-links-favicon opengraph-no-promote" src="https://www.google.com/s2/favicons?domain=disqus.com" style="display: inline-block; padding-right: 2px;" alt="(disqus.com)">
                    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow" target="_blank">comments powered by <span class="logo-disqus">Disqus</span></a>
  </article>
  <section id="right" class="col-sm-2">
    
    
<p>

                    <img class="akashacms-external-links-favicon opengraph-no-promote" src="https://www.google.com/s2/favicons?domain=twitter.com" style="display: inline-block; padding-right: 2px;" alt="(twitter.com)">
                    <a href="https://twitter.com/AkashaCMS" rel="me nofollow" class="twitter-follow-button" data-show-count="false" target="_blank">Follow<br>@AkashaCMS</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</p>

<p>
                    <img class="akashacms-external-links-favicon opengraph-no-promote" src="https://www.google.com/s2/favicons?domain=www.facebook.com" style="display: inline-block; padding-right: 2px;" alt="(www.facebook.com)">
                    <a href="https://www.facebook.com/Nodejs-Web-Development-116624021765933/" rel="me nofollow" target="_blank">Follow Node.js Web Development on Facebook</a></p>

    
<ul class="list-group">

    <li class="list-group-item">
        <a rel="nofollow noskim" href="https://www.amazon.com/gp/product/1785881507/ref=as_li_ss_il?ie=UTF8&amp;fpl=fresh&amp;pf_rd_m=ATVPDKIKX0DER&amp;pf_rd_s=&amp;pf_rd_r=6C1SVA4RRTWPTY7VN1Z2&amp;pf_rd_t=36701&amp;pf_rd_p=14bf09e4-93c8-43ff-8639-e7979e7d1787&amp;pf_rd_i=desktop&amp;linkCode=li2&amp;tag=davidherron-20&amp;linkId=1a83c9a47355206fbe8622bf9e90b086" target="_blank"><img border="0" src="https://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1785881507&amp;Format=_SL250_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=techsparx-20" width="175"></a>
    </li>

    <li class="list-group-item">
        <a rel="nofollow noskim" href="https://www.amazon.com/Asynchronous-Node-js-JavaScript-Promises-Generators-ebook/dp/B01N2Z4SOR/ref=as_li_ss_tl?ie=UTF8&amp;qid=1498526267&amp;sr=8-1&amp;keywords=asynchronous+javascript+promises+generators&amp;linkCode=ll1&amp;tag=techsparx-20&amp;linkId=0b8a5dc44c97bf8eb8452dac15ae724b" target="_blank"><img border="0" src="https://techsparx.com/nodejs/img/es-2015-16-17-promises-generators-and-async-await-2-1000.jpg" width="175"></a>
    </li>

    <li class="list-group-item">
        <a rel="nofollow noskim" href="https://www.amazon.com/Creating-eBooks-Markdown-Source-Tools-ebook/dp/B00WTKDH72/ref=as_li_ss_tl?_encoding=UTF8&amp;psc=1&amp;refRID=4SGHASEAZJKJBV0G60R0&amp;linkCode=ll1&amp;tag=techsparx-20&amp;linkId=941071a7b25f067767f82a7b11c06968" target="_blank"><img border="0" src="https://techsparx.com/nodejs/img/create-ebook-cover.jpg" width="175"></a>
    </li>

</ul>
  </section>
</div>

<footer class="row" style="text-align: center; height: 100px;">


<div class="fb-like-box" data-href="http://www.facebook.com/Akashacms" data-width="125" data-height="250" data-show-faces="false" data-stream="false" data-header="true"></div>

</footer>
</div>

<script src="../../../vendor/jquery/jquery.min.js"></script><script src="../../../vendor/popper.js/umd/popper.min.js"></script><script src="../../../vendor/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37003917-1']);
  _gaq.push(['_setDomainName', 'akashacms.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>



</body>
</html>
