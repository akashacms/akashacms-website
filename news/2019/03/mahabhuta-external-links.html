<!doctype html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!-- Consider adding a manifest.appcache: h5bp.com/d/Offline -->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width">


    <title>How to set rel=nofollow or affiliate tags in external links in a Node.js web application</title>





 
 
 
 













<meta name="pagename" content="How to set rel=nofollow or affiliate tags in external links in a Node.js web application">









<meta name="date" content="Thu Mar 28 2019 23:59:09 GMT-0700 (Pacific Daylight Time)">

<meta name="DC.title" content="How to set rel=nofollow or affiliate tags in external links in a Node.js web application">














<!-- OpenGraph Meta Tags -->

<meta name="og:title" content="How to set rel=nofollow or affiliate tags in external links in a Node.js web application">

<meta name="og:url" content="https://akashacms.com/news/2019/03/mahabhuta-external-links.html">


































<link rel="canonical" href="https://akashacms.com/news/2019/03/mahabhuta-external-links.html">

<link rel="sitemap" type="application/xml" title="Sitemap" href="../../../sitemap.xml">


<link rel="stylesheet" type="text/css" href="../../../akasha/epub-website/style.css"><link rel="stylesheet" type="text/css" href="../../../vendor/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="../../../pulse.min.css"><link rel="stylesheet" type="text/css" href="../../../style.css"><link rel="stylesheet" type="text/css" href="../../../vendor/fontawesome-free/css/all.min.css"><link rel="stylesheet" type="text/css" href="../../../vendor/highlight.js/styles/tomorrow-night-blue.css">



<!-- Facebook app for AkashaCMS fan page -->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=234745903279111";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



<!-- Twitter summary card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@akashacms">
<meta name="twitter:creator" content="@7genblogger">

<meta name="twitter:url" content="https://akashacms.com/news/2019/03/mahabhuta-external-links.html">


<meta name="twitter:title" content="How to set rel=nofollow or affiliate tags in external links in a Node.js web application">


<meta name="twitter:image" content="http://akashacms.com/logo.gif">


</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top" role="navigation">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavDropdown">
    <ul class="navbar-nav navbar-rights">
          <li class="nav-item">
              <a class="nav-link" href="../../../index.html">Home</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="../../../akasharender/toc.html">AkashaRender</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="../../../plugins/index.html">Plugins</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="../../../mahabhuta/toc.html">Mahabhuta</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="../../../epubtools/toc.html">EPUB Tools</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="../../../howto/index.html">How To</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="../../index.html">News</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="../../../about.html">About</a>
          </li>
    </ul>
  </div>
</nav>


<div class="container" role="main">
<div class="row">
<header class="col-md-12">
  <div class="row">
    <span class="col-md-8" style="text-align: center;">
      <a href="../../../index.html"><img src="../../../logo.gif" align="left"></a>
      <h1 align="center">How to set rel=nofollow or affiliate tags in external links in a Node.js web application</h1>
    </span>
    <span class="col-md-4">
      <form action="//www.google.com" id="cse-search-box">
        <div>
          <input type="hidden" name="cx" value="partner-pub-2401070691062219:4564101022">
          <input type="hidden" name="ie" value="UTF-8">
          <input type="text" name="q" size="30">
          <input type="submit" name="sa" value="Search">
        </div>
      </form>
      <script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en">
      // Not empty
      </script>
      <br>

    </span>
  </div>

</header>

</div>

<div class="row">
  <section id="breadcrumb" class="col-sm-12">
    <nav aria-label="breadcrumb" id="breadcrumbTrail">
    <ol class="breadcrumb">
     <li class="breadcrumb-item "> <a href="../../../index.html">AkashaCMS - the powerful static file CMS to build your dream website</a> </li> <li class="breadcrumb-item "> <a href="../../index.html">Announcements and News about AkashaCMS</a> </li> <li class="breadcrumb-item "> <a href="../index.html">AkashaCMS News and Announcements for 2019</a> </li> <li class="breadcrumb-item "> <a href="index.html">News for March 2019</a> </li> <li class="breadcrumb-item "> <a href="mahabhuta-external-links.html">How to set rel=nofollow or affiliate tags in external links in a Node.js web application</a> </li>
    </ol>
</nav>

  </section>
  <section id="category-tags" class="col-sm-12">
    
    Date: March 27, 2019

  </section>
  <section id="author-byline" class="col-sm-12">
    <div class="author-byline" itemprop="author" itemscope itemtype="http://schema.org/Person">
By <span itemprop="name" class="author-name-wrapper"><a href="../../../about.html" rel="author" itemprop="url">David Herron</a></span>
</div>

  </section>
</div>

<div class="row">
  <article class="col-sm-10">
    <strong><p><strong>Setting <em>rel=nofollow</em> or other attributes on outbound links is critically important.  Search engines take a dim view of outbound links where there is a monetary gain -- e.g. an affiliate link -- that lack the <em>rel=nofollow</em> attribute.  Automatically setting appropriate affiliate referral codes on all relevant external links is important for fully monetizing external links.  In this article we&apos;ll go over a new package that handles both those tasks.  It has an easy-to-use API where HTML enters the processor, and processed HTML is given as a result.  The methodology can be expanded to handle approximately a zillion other HTML DOM processing tasks.
</strong></p>
</strong> 
    <!-- no hero picture -->

    <h1>Scope of this external link processor package</h1>
<p>Let&apos;s first discuss the scope of this package.  There are two major topic areas which are not exactly common, but are unified because both areas deal with manipulating outbound links.  There are significant SEO implications for correctly setting certain attributes on outbound links, and there are significant monetization implications for correctly setting affiliate tags in outbound links.</p>
<p>The <code>rel=nofollow</code> informs search engines to not flow &quot;link juice&quot; through an outbound link.  The phrase &quot;link juice&quot; refers to the weight search engines apply to a given web page based on the number of inbound links to that page.  There are several occasions where a site will want to apply <code>rel=nofollow</code>:</p>
<ul>
<li>Poor quality scammy sites - the site may want to link to such a site, but not in a way which gives a boost to the site.  Search engines take a dim view of sites which link to scammy or poor quality sites.  Adding <code>rel=nofollow</code> is the solution</li>
<li>At the other end of the scale, some of us feel that sites like <code>cnn.com</code> or <code>wikipedia.org</code> or <code>nytimes.com</code> have enough &quot;link juice&quot; flowing to them, and therefore it is not necessary to give them any more weight than they already have</li>
<li>More recently government policies place requirements on links that earn money, including adding <code>rel=nofollow</code></li>
</ul>
<p>An affiliate link is a way to earn revenue through being paid commissions by sites based on the visitors you send to the site.  The stereotypical example is the Amazon Affiliates program, in which you link to an Amazon product page and if the visitors you send to Amazon buy things Amazon will pay a commission.  Often this involves a tag added to the <code>query</code> portion of a URL to identify which affiliate sent that visitor to account for the purchases and commissions.</p>
<h1>Installation</h1>
<p>This is a Node.js package and is installed as so:</p>
<pre><code class="hljs language-shell"><span class="hljs-meta">$</span><span class="bash"> npm install @mahabhuta/external-affiliate-links --save</span>
</code></pre>
<p>In a Node.js program it can be used as so:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> processor = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;@mahabhuta/external-affiliate-links&apos;</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;fs-extra&apos;</span>);
<span class="hljs-keyword">const</span> program   = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;commander&apos;</span>);

program
    .command(<span class="hljs-string">&apos;process &lt;htmlFN&gt;&apos;</span>)
    .description(<span class="hljs-string">&apos;Process an HTML file&apos;</span>)
    .action(<span class="hljs-keyword">async</span> (htmlFN) =&gt; {

        <span class="hljs-keyword">const</span> htmlIN = <span class="hljs-keyword">await</span> fs.readFile(htmlFN, <span class="hljs-string">&apos;utf8&apos;</span>);
        <span class="hljs-keyword">const</span> htmlOUT = <span class="hljs-keyword">await</span> processor.process(htmlIN, {}, {
            <span class="hljs-comment">// options</span>
        });
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`****** process got input HTML\n`</span>, htmlIN)
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`****** process resulted with\n`</span>, htmlOUT);
    });

program.parse(process.argv);
</code></pre>
<p>Basically, you&apos;ll have HTML to process, the processing module along with options you specify to tailor the processing, and the resulting HTML.</p>
<p>This hasn&apos;t been tested, but a brief scan through the ExpressJS documentation says this could be incorporated as an output filter in a <code>res.render</code> callback function.  Normally such a callback is implemented as:</p>
<pre><code class="hljs language-js">res.render(<span class="hljs-string">&apos;index&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, html</span>) </span>{
  res.send(html);
});
</code></pre>
<p>But the <em>external-affiliate-link</em> package could be integrated as so:</p>
<pre><code class="hljs language-js">res.render(<span class="hljs-string">&apos;index&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, html</span>) </span>{
  res.send(processor.process(html, {
      <span class="hljs-comment">// options</span>
  });
});
</code></pre>
<h2>The External/Affiliate Link package <em>options</em> object</h2>
<p>We&apos;ve mentioned this options object a couple times now, but not said what it is.  Enough with the mystery?</p>
<p>As implied this is a simple anonymous object.</p>
<p>The field <code>preferNofollow</code> says whether to start with the default of always applying <code>rel=nofollow</code>, or not applying it.  Some sites prefer to put <code>rel=nofollow</code> on all but a few outbound links, while others prefer to selectively use this setting.</p>
<p>The field <code>whitelist</code> is useful when <code>preferNoFollow</code> is true, and specifies a list of sites where <code>rel=nofollow</code> is not set.  For example</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> config_no_follow_all_whitelist_good = {
    <span class="hljs-attr">preferNofollow</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">whitelist</span>: [
        <span class="hljs-regexp">/somewhere.good$/i</span>
    ]
};
</code></pre>
<p>Contrarily the field <code>blacklist</code> is useful when <code>preferNoFollow</code> is false, and this specifies a list of sites where <code>rel=nofollow</code> is to be set.  For example:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> config_no_follow_none_blacklist_bad = {
    <span class="hljs-attr">preferNofollow</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">blacklist</span>: [
        <span class="hljs-regexp">/somewhere.bad$/i</span>
    ]
};
</code></pre>
<p>Between those three settings we have quite a lot of flexibility in controlling which sites do or do not get <code>rel=nofollow</code>.  Notice that these are regular expressions on the domain name in the <code>hostname</code> field of the URL.</p>
<h3>Controlling target=_blank</h3>
<p>Another option controls setting <code>target=_blank</code> on external links.  This is a blanket setting, whether to always use that behavior or not.  In any options object add this field:</p>
<pre><code class="hljs language-js">targetBlank: <span class="hljs-literal">true</span>
</code></pre>
<h3>Showing <em>favicons</em> next to a link</h3>
<p>Another option controls displaying the <em>favicon</em> of the target site next to outbound links.  The <em>favicon</em> is that little icon appearing in the URL location bar.  It is useful to add this as an indicator of an external link, and to help your viewer know where that link heads to.  In any options object add this field:</p>
<pre><code class="hljs language-js">showFavicons: <span class="hljs-string">&quot;before&quot;</span>,
</code></pre>
<p>The value can be <em>before</em> or <em>after</em> controlling whether the <em>favicon</em> appears before the link or afterward.</p>
<p>Under the covers a little-known Google service is used to retrieve the <em>favicon</em>.</p>
<h3>Showing small image next to the link</h3>
<p>Another option also informs the user that it is an external link, by showing a little blip of an image next to the link.  Like for the <em>showFavicons</em> setting, it takes a value of <em>before</em> or <em>after</em>.  In any options object add this field:</p>
<pre><code class="hljs language-js">showIcon: <span class="hljs-string">&quot;after&quot;</span>,
</code></pre>
<h3>Adding affiliate tags to outbound links</h3>
<p>There are somewhere around a zillion websites offering affiliate programs.  We are offering here a software module to automatically add affiliate links, and obviously we cannot have covered all the zillion affiliate programs that are available.  Instead the package currently supports three programs, but it is easy to add others as desired.  Pull requests are gladly accepted.</p>
<p>In the options object we specify an array of objects in the <code>affiliateDomains</code> field.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> config_amazon_com = {
    <span class="hljs-attr">preferNofollow</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">targetBlank</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">showFavicons</span>: <span class="hljs-string">&quot;before&quot;</span>,
    <span class="hljs-attr">showIcon</span>: <span class="hljs-string">&quot;after&quot;</span>,
    <span class="hljs-attr">affiliateDomains</span>: [
        {
            <span class="hljs-attr">domain</span>: <span class="hljs-string">&quot;amazon.com&quot;</span>,
            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;AMAZON&quot;</span>,
            <span class="hljs-attr">trackingCode</span>: <span class="hljs-string">&quot;foobar-20&quot;</span>,
            <span class="hljs-attr">nofollow</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">noskim</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">novig</span>: <span class="hljs-literal">true</span>
        },
        {
            <span class="hljs-attr">domain</span>: <span class="hljs-string">&quot;amazon.ca&quot;</span>,
            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;AMAZON&quot;</span>,
            <span class="hljs-attr">trackingCode</span>: <span class="hljs-string">&quot;foobar-ca-20&quot;</span>,
            <span class="hljs-attr">nofollow</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">noskim</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">novig</span>: <span class="hljs-literal">true</span>
        },
        {
            <span class="hljs-attr">domain</span>: <span class="hljs-string">&quot;amazon.co.uk&quot;</span>,
            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;AMAZON&quot;</span>,
            <span class="hljs-attr">trackingCode</span>: <span class="hljs-string">&quot;foobar-co-uk-20&quot;</span>,
            <span class="hljs-attr">nofollow</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">noskim</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">novig</span>: <span class="hljs-literal">true</span>
        },
        {
            <span class="hljs-attr">domain</span>: <span class="hljs-string">&quot;amazon.fr&quot;</span>,
            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;AMAZON&quot;</span>,
            <span class="hljs-attr">trackingCode</span>: <span class="hljs-string">&quot;foobar-fr-20&quot;</span>,
            <span class="hljs-attr">nofollow</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">noskim</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">novig</span>: <span class="hljs-literal">true</span>
        },
        {
            <span class="hljs-attr">domain</span>: <span class="hljs-string">&quot;amazon.de&quot;</span>,
            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;AMAZON&quot;</span>,
            <span class="hljs-attr">trackingCode</span>: <span class="hljs-string">&quot;foobar-de-20&quot;</span>,
            <span class="hljs-attr">nofollow</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">noskim</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">novig</span>: <span class="hljs-literal">false</span>
        }
    ]
};
</code></pre>
<p>This is an example covering several Amazon sites.  Each Amazon operation in each country has traditionally had a separate affiliate program.</p>
<p>In each of these objects are several common fields:</p>
<ul>
<li><code>domain</code> is a string to match against the <code>hostname</code> field of the URL.  It is an <code>endsWith</code> match, and therefore will match any hostname ending with the value in <code>domain</code></li>
<li><code>type</code> specifies which kind of affiliate program it is.  We use this under the covers to apply specific transformations to the URL for the specific destination.  In this case <code>AMAZON</code> clearly means an Amazon affiliate program.</li>
<li><code>trackingCode</code> is the code assigned to your account by the affiliate program.</li>
<li><code>nofollow</code> specifies whether to set <code>rel=nofollow</code> on the link</li>
<li><code>noskim</code> and <code>novig</code> specify whether to set <code>rel=</code> values to inform Skimlinks or Viglinks to not rewrite the URL for their system</li>
</ul>
<p>Zazzle is a marketplace allowing folks to design custom-made products by uploading images that Zazzle prints on to the product.  The Zazzle options object looks the same as the Amazon object, except that you put <code>zazzle.com</code> as the <code>domain</code>, and <code>ZAZZLE</code> as the <code>type</code>.</p>
<p>Rakuten operates a large network of affiliate programs where many thousands of merchants use Rakuten&apos;s services to manage their affiliate program.  Therefore we have a long list of potential affiliate partners available through site, and more importantly they all use the same rewriting strategy.  Their affiliate object looks a little different:</p>
<pre><code class="hljs language-js">{
    <span class="hljs-attr">domain</span>: <span class="hljs-string">&quot;rakuten.foo&quot;</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;RAKUTEN&quot;</span>,
    <span class="hljs-attr">trackingCode</span>: <span class="hljs-string">&quot;rakutenTrackingFoo&quot;</span>,
    <span class="hljs-attr">mid</span>: <span class="hljs-string">&quot;rakutenMIDfoo&quot;</span>,
    <span class="hljs-attr">nofollow</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">noskim</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">novig</span>: <span class="hljs-literal">true</span>
}
</code></pre>
<p>Most of this is the same, other than <code>RAKUTEN</code> for the <code>type</code> and that new field labeled <code>mid</code>.  It is a value you get from Rakuten along with your <code>trackingCode</code>.</p>
<h1>But, wait, there&apos;s more</h1>
<p>At the top I mentioned: <em>The methodology can be expanded to handle approximately a zillion other HTML DOM processing tasks.</em>  Here&apos;s where we explain that sentence.</p>
<p>The <code>processor.process</code> method mentioned earlier is a simplification of using Mahabhuta to execute an array of Mahafuncs.  If you just went MahaWhata, let me explain.</p>
<p>Mahabhuta is a companion project to AkashaCMS.  Both Mahabhuta and Akasha are sanskrit words -- so far as I understand it, <em>Mahabhuta</em> is the name for all the elements which make up the world, of which one is <em>Akasha</em>.  Ergo, Mahabhuta has to do with elements, and therefore in this context it refers to processing HTML elements.</p>
<p>Put another way, Mahabhuta is an engine for processing the HTML DOM in a Node.js program.  It relies on the Cheerio package, meaning that a programmer writing a Mahafunc is writing jQuery-like code to manipulate the DOM.</p>
<p>The word Mahafunc is probably another MahaWhat.  The programmer using Mahabhuta provides it an array of processing functions, each of which is called a Mahafunc (short for Mahabhuta Function).  Well, <em>array</em> is too simple because it can handle arrays of arrays of arrays of functions.  Each Mahafunc is implemented with the jQuery-like API provided by Cheerio.</p>
<p>Inside <code>@mahabhuta/external-affiliate-links</code> is these functions:</p>
<pre><code class="hljs language-js"><span class="hljs-built_in">module</span>.exports.process = <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">text, metadata, options</span>) </span>{
    <span class="hljs-keyword">let</span> funcs = <span class="hljs-built_in">module</span>.exports.mahabhutaArray(options);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> mahabhuta.processAsync(text, metadata, funcs);
};

<span class="hljs-built_in">module</span>.exports.mahabhutaArray = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
    <span class="hljs-keyword">let</span> ret = <span class="hljs-keyword">new</span> mahabhuta.MahafuncArray(pluginName, options);
    ret.addMahafunc(<span class="hljs-keyword">new</span> ExternalLinkMunger());
    <span class="hljs-keyword">return</span> ret;
};
</code></pre>
<p>In <code>mahabhutaArray</code> we construct a MahafuncArray -- an Array-like object to hold Mahafunc&apos;s -- containing the Mahafunc defined by the <em>ExternalLinkMunger</em> class.  The <em>options</em> object described earlier is passed into this function.  The <em>pluginName</em> variable gives a human-readable name to the Array.</p>
<p>In <code>process</code> we see the MahabhutaArray being used in calling <code>mahabhuta.processAsync</code>.  The <code>text</code> object must be HTML, because inside Mahabhuta it will be handed to Cheerio which will throw errors if it is not HTML.  The <code>metadata</code> object can provide some data which can be accessed by Mahafunc&apos;s.  The <code>options</code> object is what we saw earlier, and is simply passed into the MahafuncArray constructor.</p>
<p>Maybe it&apos;s clear from this that a MahafuncArray is intended to hold a group of related Mahafunc&apos;s.  Each gets access to a common <em>options</em> object, for example.</p>
<p>What&apos;s not shown here is that in addition to adding a Mahafunc to a MahafuncArray, you can also add a MahafuncArray.  As I said earlier, MahafuncArray&apos;s can be nested to any depth you like.</p>
<p>The <code>mahabhuta.processAsync</code> function executes each Mahafunc in order, stepping into each MahafuncArray as needed.</p>
<h2>Threaded Interpreted Languages</h2>
<p>Back in 1983 I read an article in a computer science journal about <em>Threaded Interpreted Languages</em>.  This technique was used by the FORTH interpreter -- FORTH being an early interpreted programming language.  A FORTH program gets compiled down to byte codes, that are stored in an array, and the FORTH interpreter steps through the byte codes to execute the FORTH program.</p>
<p>In 1983 I wrote a BASIC interpreter using that technique.  The BASIC program was compiled down to a series of byte codes, and executed in an interpreter written in C.  With that program I got an A from the professor, and he later hired me to run some computer systems in the Computer Science department.</p>
<p>I mention this because Mahabhuta uses essentially the same model.  A MahafuncArray is an array of operations, each operation being described by a JavaScript class subclassing from Mahafunc.  The Mahafunc&apos;s are executed one by one, just like in a TIL implementation, and there are rules to cause re-execution of the Mahafunc&apos;s as needed.  For example if one Mahafunc inserts tags into the HTML which must be processed by another Mahafunc.</p>

    <div class="btn-group blog-prev-next-wrapper" role="group" aria-label="Next/Previous">
    <a class="btn btn-outline-primary blog-prev-link" href="../07/akasharender-mahabhuta-0-7.html" role="button">
    &#xAB;&#xAB;&#xAB;&#xAB;&#xAB;&#xAB; Announcing 0.7 release of AkashaRender and Mahabhuta</a>
    <a class="btn btn-outline-primary blog-next-link" href="../02/bootstrapv4.html" role="button">
    <span style="float: right">Updating an AkashaCMS site to use Bootstrap v4.3.x &#xBB;&#xBB;&#xBB;&#xBB;&#xBB;&#xBB;</span></a>
</div>
    <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'akashacms'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the 
                    <img class="akashacms-external-links-favicon opengraph-no-promote" src="https://www.google.com/s2/favicons?domain=disqus.com" style="display: inline-block; padding-right: 2px;" alt="(disqus.com)">
                    <a href="https://disqus.com/?ref_noscript" rel="nofollow" target="_blank">comments powered by Disqus.</a></noscript>

                    <img class="akashacms-external-links-favicon opengraph-no-promote" src="https://www.google.com/s2/favicons?domain=disqus.com" style="display: inline-block; padding-right: 2px;" alt="(disqus.com)">
                    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow" target="_blank">comments powered by <span class="logo-disqus">Disqus</span></a>
  </article>
  <section id="right" class="col-sm-2">
    
    
<p>

                    <img class="akashacms-external-links-favicon opengraph-no-promote" src="https://www.google.com/s2/favicons?domain=twitter.com" style="display: inline-block; padding-right: 2px;" alt="(twitter.com)">
                    <a href="https://twitter.com/AkashaCMS" rel="me nofollow" class="twitter-follow-button" data-show-count="false" target="_blank">Follow<br>@AkashaCMS</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</p>

<p>
                    <img class="akashacms-external-links-favicon opengraph-no-promote" src="https://www.google.com/s2/favicons?domain=www.facebook.com" style="display: inline-block; padding-right: 2px;" alt="(www.facebook.com)">
                    <a href="https://www.facebook.com/Nodejs-Web-Development-116624021765933/" rel="me nofollow" target="_blank">Follow Node.js Web Development on Facebook</a></p>

    
<ul class="list-group">

    <li class="list-group-item">
        <a rel="nofollow noskim" href="https://www.amazon.com/gp/product/1785881507/ref=as_li_ss_il?ie=UTF8&amp;fpl=fresh&amp;pf_rd_m=ATVPDKIKX0DER&amp;pf_rd_s=&amp;pf_rd_r=6C1SVA4RRTWPTY7VN1Z2&amp;pf_rd_t=36701&amp;pf_rd_p=14bf09e4-93c8-43ff-8639-e7979e7d1787&amp;pf_rd_i=desktop&amp;linkCode=li2&amp;tag=davidherron-20&amp;linkId=1a83c9a47355206fbe8622bf9e90b086" target="_blank"><img border="0" src="https://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1785881507&amp;Format=_SL250_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=techsparx-20" width="175"></a>
    </li>

    <li class="list-group-item">
        <a rel="nofollow noskim" href="https://www.amazon.com/Asynchronous-Node-js-JavaScript-Promises-Generators-ebook/dp/B01N2Z4SOR/ref=as_li_ss_tl?ie=UTF8&amp;qid=1498526267&amp;sr=8-1&amp;keywords=asynchronous+javascript+promises+generators&amp;linkCode=ll1&amp;tag=techsparx-20&amp;linkId=0b8a5dc44c97bf8eb8452dac15ae724b" target="_blank"><img border="0" src="https://techsparx.com/nodejs/img/es-2015-16-17-promises-generators-and-async-await-2-1000.jpg" width="175"></a>
    </li>

    <li class="list-group-item">
        <a rel="nofollow noskim" href="https://www.amazon.com/Creating-eBooks-Markdown-Source-Tools-ebook/dp/B00WTKDH72/ref=as_li_ss_tl?_encoding=UTF8&amp;psc=1&amp;refRID=4SGHASEAZJKJBV0G60R0&amp;linkCode=ll1&amp;tag=techsparx-20&amp;linkId=941071a7b25f067767f82a7b11c06968" target="_blank"><img border="0" src="https://techsparx.com/nodejs/img/create-ebook-cover.jpg" width="175"></a>
    </li>

</ul>
  </section>
</div>

<footer class="row" style="text-align: center; height: 100px;">
<!-- partial file-name="ebook-footer.html"/ -->

<div class="fb-like-box" data-href="http://www.facebook.com/Akashacms" data-width="125" data-height="250" data-show-faces="false" data-stream="false" data-header="true"></div>

</footer>
</div>

<script src="../../../vendor/jquery/jquery.min.js"></script><script src="../../../vendor/popper.js/umd/popper.min.js"></script><script src="../../../vendor/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37003917-1']);
  _gaq.push(['_setDomainName', 'akashacms.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<!-- partial file-name="piwik_analytics.html"></partial -->


</body>
</html>
